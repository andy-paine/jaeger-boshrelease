---
name: jaeger-all-in-one
packages:
- jaeger

templates:
  config/bpm.yml.erb: config/bpm.yml
  tls/collector/grpc.key.erb: tls/collector/grpc.key
  tls/collector/grpc.crt.erb: tls/collector/grpc.crt
  tls/collector/grpc-client-ca.crt.erb: tls/collector/grpc-client-ca.crt
  tls/reporter/grpc.key.erb: tls/reporter/grpc.key
  tls/reporter/grpc.crt.erb: tls/reporter/grpc.crt
  tls/reporter/grpc-ca.crt.erb: tls/reporter/grpc-ca.crt

properties:
  span_storage_type:
    description: "What span storage type to use. Supported values are: memory, badger, elasticsearch, cassandra"
    default: badger
  memory.max-traces:
    description: The maximum amount of traces to store in memory
    default: 0
  badger.consistency:
    description: If all writes should be synced immediately to physical disk. This will impact write performance.
    default: false
  badger.maintenance-interval:
    description: "How often the maintenance thread for values is ran. Format is time.Duration (https://golang.org/pkg/time/#Duration)"
    default: 5m0s
  badger.metrics-update-interval:
    description: "How often the badger metrics are collected by Jaeger. Format is time.Duration (https://golang.org/pkg/time/#Duration)"
    default: 10s
  badger.read-only:
    description: Allows to open badger database in read only mode. Multiple instances can open same database in read-only mode. Values still in the write-ahead-log must be replayed before opening.
    default: false
  badger.span-store-ttl:
    description: "How long to store the data. Format is time.Duration (https://golang.org/pkg/time/#Duration)"
    default: 72h0m0s
  badger.truncate:
    description: If write-ahead-log should be truncated on restart. this will cause data loss.
    default: false
  collector.grpc-port:
    description: "The gRPC port for the collector service"
    default: 14250
  collector.grpc.tls.client-ca:
    description: CA certificate used to verify certificates presented by clients (if unset, all clients are permitted)
    example: |
      -----BEGIN CERTIFICATE-----
      etc.
  collector.grpc.tls.certificate:
    description: TLS certificate, used to identify this server to clients
    example: |
      -----BEGIN CERTIFICATE-----
      etc.
  collector.grpc.tls.private_key:
    description: TLS private key, used to identify this server to clients
    example: |
      -----BEGIN RSA PRIVATE KEY-----
      etc.
  collector.http-port:
    description: The HTTP port for the collector service
    default: 14268
  collector.num-workers:
    description: The number of workers pulling items from the queue
    default: 50
  collector.port:
    description: The TChannel port for the collector service
    default: 14267
  collector.queue-size:
    description: The queue size of the collector
    default: 2000
  collector.queue-size-memory:
    description: (Experimental) The max memory size in MiB to use for the dynamic queue
    default: 0
  collector.tags:
    description: One or more tags to be added to the Process tags of all spans passing through this collector
    example:
      env: foo
      region: bar
  collector.zipkin.allowed-headers:
    description: List of allowed headers for the Zipkin collector service
    default:
    - content-type
  collector.zipkin.allowed-origins:
    description: List of allowed origins for the Zipkin collector service
    default:
    - "*"
  collector.zipkin.http-port:
    description: The HTTP port for the Zipkin collector service e.g. 9411
    default: 0
  processor.jaeger-binary.server-host-port:
    description: host:port for the jaeger-binary UDP server
    default: ":6832"
  processor.jaeger-binary.server-max-packet-size:
    description: Max packet size for the jaeger-binary UDP server
    default: 65000
  processor.jaeger-binary.server-queue-size:
    description: Length of the queue for the jaeger-binary UDP server
    default: 1000
  processor.jaeger-binary.workers:
    description: How many jaeger-binary workers the processor should run
    default: 10
  processor.jaeger-compact.server-host-port:
    description: host:port for the jaeger-compact UDP server
    default: ":6831"
  processor.jaeger-compact.server-max-packet-size:
    description: Max packet size for the jaeger-compact UDP server
    default: 65000
  processor.jaeger-compact.server-queue-size:
    description: Length of the queue for the jaeger-compact UDP server
    default: 1000
  processor.jaeger-compact.workers:
    description: How many jaeger-compact workers the processor should run
    default: 10
  processor.zipkin-compact.server-host-port:
    description: host:port for the zipkin-compact UDP server
    default: ":5775"
  processor.zipkin-compact.server-max-packet-size:
    description: Max packet size for the zipkin-compact UDP server
    default: 65000
  processor.zipkin-compact.server-queue-size:
    description: Length of the queue for the zipkin-compact UDP server
    default: 1000
  processor.zipkin-compact.workers:
    description: How many zipkin-compact workers the processor should run
    default: 10
  reporter.grpc.discovery.min-peers:
    description: Max number of collectors to which the agent will try to connect at any given time
    default: 3
  reporter.grpc.retry.max:
    description: Sets the maximum number of retries for a call
    default: 3
  reporter.grpc.tls.skip-host-verify:
    description: (insecure) Skip server's certificate chain and host name verification
    default: false
  reporter.grpc.host-port:
    description: "List of host:port representing collectors to connect to directly"
    example:
    - "example.com:14250"
  reporter.grpc.tls.ca:
    description: TLS CA used to verify the remote server(s) (by default will use the system truststore)
    example: |
      -----BEGIN CERTIFICATE-----
      etc.
  reporter.grpc.tls.certificate:
    description: TLS certificate, used to identify this process to the remote server(s)
    example: |
      -----BEGIN CERTIFICATE-----
      etc.
  reporter.grpc.tls.private_key:
    description: TLS private key, used to identify this process to the remote server(s)
    example: |
      -----BEGIN RSA PRIVATE KEY-----
      etc.
  reporter.grpc.tls.server-name:
    description: Override the TLS server name we expect in the certificate of the remove server(s)